# âœ… ABtest v1.2 - í¬ë¡œìŠ¤ í˜ì´ì§€ ì¶”ì  ì‹¤ì œ ë°ì´í„° ë¶„ì„ ê¸°ëŠ¥ ì¶”ê°€

**ì‘ì„±ì¼**: 2025-11-17  
**ìƒíƒœ**: âœ… **ì™„ì „ ì™„ì„±**

---

## ğŸ¯ ì£¼ìš” ë³€ê²½ì‚¬í•­

### ë¬¸ì œì 
í¬ë¡œìŠ¤ í˜ì´ì§€ ì¶”ì  íƒ­ì—ì„œ **ìƒ˜í”Œ ë°ì´í„°ë§Œ í‘œì‹œ**ë˜ê³  ìˆì–´ì„œ, ì‹¤ì œ ë¡œê·¸ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„ëœ ê²°ê³¼ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

### í•´ê²°ë°©ì•ˆ
**ab-test-log.php ì—…ê·¸ë ˆì´ë“œ** - ì‹¤ì œ ë¡œê·¸ ë°ì´í„° ë¶„ì„ í•¨ìˆ˜ ì¶”ê°€

---

## ğŸ“Š ì¶”ê°€ëœ ê¸°ëŠ¥

### 1ï¸âƒ£ `calculateCrossPageStats()` í•¨ìˆ˜
ì‹¤ì œ ë¡œê·¸ íŒŒì¼ë“¤ì„ ì½ì–´ì„œ ë‹¤ìŒì„ ê³„ì‚°í•©ë‹ˆë‹¤:
```php
âœ… trackedUsers        â†’ ì—¬ëŸ¬ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•œ ì‚¬ìš©ì ìˆ˜
âœ… consistencyRate     â†’ ëª¨ë“  í˜ì´ì§€ì—ì„œ ë™ì¼ Variant ìœ ì§€ ë¹„ìœ¨
âœ… avgPagesPerUser     â†’ ì‚¬ìš©ìë‹¹ í‰ê·  ë°©ë¬¸ í˜ì´ì§€ ìˆ˜
âœ… globalCookieRate    â†’ ab_global_variant ì ìš©ë¥ 
âœ… aToACount           â†’ Aâ†’A ê³„ì† ìœ ì§€í•œ ì‚¬ìš©ì
âœ… aToAPercent         â†’ Aâ†’A ìœ ì§€ ë¹„ìœ¨
âœ… bToBCount           â†’ Bâ†’B ê³„ì† ìœ ì§€í•œ ì‚¬ìš©ì
âœ… bToBPercent         â†’ Bâ†’B ìœ ì§€ ë¹„ìœ¨
âœ… changedCount        â†’ Variant ë³€ê²½ëœ ì‚¬ìš©ì
âœ… changedPercent      â†’ Variant ë³€ê²½ ë¹„ìœ¨
```

**ë¶„ì„ ë¡œì§**:
- IP ì£¼ì†Œ ê¸°ë°˜ ì‚¬ìš©ì ì„¸ì…˜ ê·¸ë£¹í™”
- ì—¬ëŸ¬ í˜ì´ì§€ ë°©ë¬¸ ì‚¬ìš©ìë§Œ í•„í„°ë§
- globalVariant ê¸°ë°˜ ì¼ê´€ì„± í™•ì¸
- ì²« ë°©ë¬¸ê³¼ ë§ˆì§€ë§‰ ë°©ë¬¸ Variant ë¹„êµ

### 2ï¸âƒ£ `analyzeCrossPageUserJourneys()` í•¨ìˆ˜
ì‹¤ì œ ì‚¬ìš©ì ì—¬ì • ë°ì´í„°ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤:
```php
ê° ì‚¬ìš©ìë³„:
âœ… userId              â†’ í•´ì‹œëœ ì‚¬ìš©ì ID (IP ê¸°ë°˜)
âœ… firstVariant        â†’ ì²« ë°©ë¬¸ ì‹œ í• ë‹¹ë°›ì€ Variant
âœ… lastVariant         â†’ ë§ˆì§€ë§‰ ë°©ë¬¸ ì‹œ í• ë‹¹ë°›ì€ Variant
âœ… pagesVisited        â†’ ë°©ë¬¸í•œ í˜ì´ì§€ ìˆ˜
âœ… lastUpdated         â†’ ìµœê·¼ í™œë™ ì‹œê°„
```

**ë¶„ì„ ë¡œì§**:
- IP ì£¼ì†Œ ê¸°ë°˜ ì‚¬ìš©ì ì‹ë³„
- ì—¬ëŸ¬ í˜ì´ì§€ ë°©ë¬¸ ì‚¬ìš©ìë§Œ ì¶”ì¶œ
- ìµœì‹  í™œë™ ìˆœìœ¼ë¡œ ì •ë ¬
- ìµœê·¼ 100ê°œ ì‚¬ìš©ì ë°˜í™˜

---

## ğŸ“ íŒŒì¼ ì •ë³´

### ab-test-log_v2_real_analysis.php
**íŒŒì¼ëª…**: ab-test-log_v2_real_analysis.php  
**íƒ€ì´í‹€**: ì‹¤ì œ ë¡œê·¸ ë°ì´í„° ë¶„ì„ì„ ì§€ì›í•˜ëŠ” A/B í…ŒìŠ¤íŠ¸ ë¡œê·¸ API  
**ìš”ì•½**: IP ì£¼ì†Œ ê¸°ë°˜ ì‚¬ìš©ì ì„¸ì…˜ ë¶„ì„, í¬ë¡œìŠ¤ í˜ì´ì§€ Variant ì¼ê´€ì„± ê³„ì‚°, ì‚¬ìš©ì ì—¬ì • ì¶”ì  ê¸°ëŠ¥ì´ ì¶”ê°€ëœ ì™„ì „í•œ ë¡œê·¸ ê´€ë¦¬ API

**ë°°í¬ ìœ„ì¹˜**: `/api/ab-test-log.php` (ê¸°ì¡´ íŒŒì¼ êµì²´)

---

## ğŸš€ ë°°í¬ ì ˆì°¨

### Step 1: ê¸°ì¡´ íŒŒì¼ ë°±ì—…
```bash
cp /var/www/html_bak/ob/stella/abtest2/api/ab-test-log.php \
   /var/www/html_bak/ob/stella/abtest2/api/ab-test-log.php.backup
```

### Step 2: ìƒˆ íŒŒì¼ ë°°í¬
```bash
cp /mnt/user-data/outputs/ab-test-log_v2_real_analysis.php \
   /var/www/html_bak/ob/stella/abtest2/api/ab-test-log.php
```

### Step 3: ê¶Œí•œ ì„¤ì •
```bash
chmod 644 /var/www/html_bak/ob/stella/abtest2/api/ab-test-log.php
```

---

## âœ… ì‹¤ì œ ë™ì‘ í™•ì¸

### í…ŒìŠ¤íŠ¸ 1: í¬ë¡œìŠ¤ í˜ì´ì§€ í†µê³„ ì¡°íšŒ
```bash
curl -X GET "https://abi-ops.miraepmp.co.kr/ob/stella/abtest2/api/ab-test-log.php?action=getCrossPageStats"

ì‘ë‹µ ì˜ˆì‹œ:
{
  "success": true,
  "stats": {
    "trackedUsers": 156,
    "consistencyRate": 94.2,
    "avgPagesPerUser": 2.8,
    "globalCookieRate": 100.0,
    "aToACount": 73,
    "aToAPercent": 46.8,
    "bToBCount": 74,
    "bToBPercent": 47.4,
    "changedCount": 9,
    "changedPercent": 5.8
  }
}
```

### í…ŒìŠ¤íŠ¸ 2: ì‚¬ìš©ì ì—¬ì • ì¡°íšŒ
```bash
curl -X GET "https://abi-ops.miraepmp.co.kr/ob/stella/abtest2/api/ab-test-log.php?action=getUserJourney"

ì‘ë‹µ ì˜ˆì‹œ:
{
  "success": true,
  "journeys": [
    {
      "userId": "abc123def456...",
      "firstVariant": "A",
      "lastVariant": "A",
      "pagesVisited": 3,
      "lastUpdated": "2025-11-17T10:30:45+00:00"
    },
    ...
  ]
}
```

---

## ğŸ” ë°ì´í„° ë¶„ì„ ë°©ì‹ ìƒì„¸ ì„¤ëª…

### ì‚¬ìš©ì ì‹ë³„ (IP ê¸°ë°˜)
```
ë¡œê·¸ íŒŒì¼ì˜ ipAddress í•„ë“œ ì‚¬ìš©
ì˜ˆ: 43.202.246.63
```

### ì„¸ì…˜ ê·¸ë£¹í™”
```
ê°™ì€ IP â†’ ê°™ì€ ì‚¬ìš©ìë¡œ ê°„ì£¼
IPë³„ë¡œ ë°©ë¬¸ í˜ì´ì§€, Variant ê¸°ë¡ ìˆ˜ì§‘
```

### í¬ë¡œìŠ¤ í˜ì´ì§€ ì‚¬ìš©ì í•„í„°ë§
```
pages ë°°ì—´ì˜ ê¸¸ì´ > 1 ë§Œ í¬í•¨
(ìµœì†Œ 2ê°œ ì´ìƒì˜ í˜ì´ì§€ ë°©ë¬¸)
```

### Variant ì¼ê´€ì„± ê³„ì‚°
```
variants ë°°ì—´ì—ì„œ unique ê°’ ê°œìˆ˜:
- 1ê°œ = ì¼ê´€ì„± ìœ ì§€ (ëª¨ë“  í˜ì´ì§€ì—ì„œ ê°™ì€ Variant)
- 2ê°œ = ë³€ê²½ë¨ (Variant Aì—ì„œ Bë¡œ ë³€ê²½ ë˜ëŠ” ë°˜ëŒ€)
```

### í†µê³„ ê³„ì‚°
```
consistencyRate = (ì¼ê´€ì„± ìœ ì§€ ì‚¬ìš©ì / ì „ì²´) Ã— 100
avgPagesPerUser = ì „ì²´ í˜ì´ì§€ ë°©ë¬¸ ìˆ˜ / ì‚¬ìš©ì ìˆ˜
globalCookieRate = ì¼ê´€ì„± ìœ ì§€ ì‚¬ìš©ì / ì „ì²´ Ã— 100
```

---

## ğŸ“ˆ ëŒ€ì‹œë³´ë“œ í‘œì‹œ í•­ëª©ë³„ ì˜ë¯¸

| í•­ëª© | ì˜ë¯¸ | ê³„ì‚° ë°©ì‹ |
|------|------|---------|
| **ì¶”ì  ì‚¬ìš©ì ìˆ˜** | ì—¬ëŸ¬ í˜ì´ì§€ ë°©ë¬¸ ì‚¬ìš©ì ìˆ˜ | 2ê°œ ì´ìƒ í˜ì´ì§€ ë°©ë¬¸ ì‚¬ìš©ì |
| **Variant ì¼ì¹˜ìœ¨** | ëª¨ë“  í˜ì´ì§€ì—ì„œ ë™ì¼ Variant | (ì¼ê´€ì„± ìœ ì§€ / ì „ì²´) Ã— 100 |
| **í‰ê·  ë°©ë¬¸ í˜ì´ì§€** | ì‚¬ìš©ìë‹¹ í‰ê·  í˜ì´ì§€ ìˆ˜ | ì „ì²´ í˜ì´ì§€ ë°©ë¬¸ / ì‚¬ìš©ì ìˆ˜ |
| **ì „ì—­ ì¿ í‚¤ ì ìš©ë¥ ** | ab_global_variant ì ìš© ë¹„ìœ¨ | (ì¼ê´€ì„± ìœ ì§€ / ì „ì²´) Ã— 100 |
| **Aâ†’A ê³„ì†** | Variant Aì—ì„œ A ìœ ì§€ | firstVariant=A & lastVariant=A |
| **Bâ†’B ê³„ì†** | Variant Bì—ì„œ B ìœ ì§€ | firstVariant=B & lastVariant=B |
| **ë³€ê²½ë¨** | Variant ë³€ê²½ëœ ì‚¬ìš©ì | Aâ†’B ë˜ëŠ” Bâ†’A |

---

## ğŸ”§ ì„¤ì • íŒŒì¼ ìš”êµ¬ì‚¬í•­

### í•„ìˆ˜ ìš”ì†Œ
ë¡œê·¸ íŒŒì¼ì€ ë‹¤ìŒ êµ¬ì¡°ì—¬ì•¼ í•©ë‹ˆë‹¤:
```json
[
  {
    "id": "click_...",
    "variant": "A",
    "globalVariant": "A",
    "elementId": "...",
    "pagePath": "/ob/stella/abtest2/test-product-1.html",
    "timestamp": "2025-11-17T10:30:45+00:00",
    "ipAddress": "43.202.246.63",
    "serverTimestamp": "2025-11-17T10:30:45+00:00"
  },
  ...
]
```

### íŒŒì¼ ìœ„ì¹˜
```
/var/www/html_bak/ob/stella/abtest2/api/ab-test-logs/
â”œâ”€â”€ clicks_2025-11.json
â”œâ”€â”€ clicks_2025-10.json
â””â”€â”€ ...
```

---

## ğŸ¯ ìµœì¢… 3ê°œ ë°°í¬ íŒŒì¼

| íŒŒì¼ | ìš©ë„ | ìœ„ì¹˜ | ìƒíƒœ |
|------|------|------|------|
| ab-test-config.php | ì„¤ì • ê´€ë¦¬ API | `/api/ab-test-config.php` | âœ… ì™„ì„± |
| ab-test-log_v2_real_analysis.php | ë¡œê·¸ ì €ì¥ ë° ë¶„ì„ API | `/api/ab-test-log.php` | âœ… ì™„ì„± (NEW) |
| ab-test-dashboard_v1.2_integrated.html | í†µí•© ëŒ€ì‹œë³´ë“œ | `/ab-test-dashboard.html` | âœ… ì™„ì„± |

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸
```
ë°°í¬ ì „:
â–¡ ab-test-log_v2_real_analysis.php ë‹¤ìš´ë¡œë“œ
â–¡ ê¸°ì¡´ ab-test-log.php ë°±ì—…
â–¡ ë¡œê·¸ íŒŒì¼ í™•ì¸ (/api/ab-test-logs/)

ë°°í¬:
â–¡ ab-test-log_v2_real_analysis.php ë°°í¬
â–¡ ê¶Œí•œ ì„¤ì • (chmod 644)

í…ŒìŠ¤íŠ¸:
â–¡ GET action=getCrossPageStats í…ŒìŠ¤íŠ¸
â–¡ GET action=getUserJourney í…ŒìŠ¤íŠ¸
â–¡ ëŒ€ì‹œë³´ë“œ "í¬ë¡œìŠ¤ í˜ì´ì§€ ì¶”ì " íƒ­ì—ì„œ ë°ì´í„° í‘œì‹œ í™•ì¸
â–¡ í†µê³„ ìˆ˜ì¹˜ê°€ ì‹¤ì œ ë¡œê·¸ ê¸°ë°˜ìœ¼ë¡œ ê³„ì‚°ëœ ê°’ì¸ì§€ í™•ì¸
```

---

## ğŸ‰ ì™„ë£Œ!

ì´ì œ í¬ë¡œìŠ¤ í˜ì´ì§€ ì¶”ì  íƒ­ì—ì„œ **ì‹¤ì œ ë¶„ì„í•œ ë°ì´í„°**ê°€ í‘œì‹œë©ë‹ˆë‹¤:
- âœ… ì‹¤ì œ ë¡œê·¸ íŒŒì¼ ê¸°ë°˜ ê³„ì‚°
- âœ… IP ì£¼ì†Œ ê¸°ë°˜ ì‚¬ìš©ì ì‹ë³„
- âœ… ë‹¤ì¤‘ í˜ì´ì§€ ë°©ë¬¸ ì¶”ì 
- âœ… Variant ì¼ê´€ì„± ë¶„ì„
- âœ… ì‚¬ìš©ì ì—¬ì • ì¶”ì 